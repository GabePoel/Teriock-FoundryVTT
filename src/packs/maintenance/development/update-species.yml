folder: L08qIbjJoCwEaiEi
name: Update Species
type: script
_id: U0WfGPoPSLSystNU
author: teriockBuilder00
img: systems/teriock/src/icons/documents/species.svg
scope: global
command: |-
  const speciesPack = game.teriock.packs.species;
  await speciesPack.getIndex();

  const folderConfigs = [
    { name: "Monster Species", variable: "allSpeciesFolder" },
    { name: "Character Species", variable: "characterSpeciesFolder" },
    { name: "Common Animal Species", variable: "commonAnimalSpeciesFolder" },
    { name: "Undead Species", variable: "undeadSpeciesFolder" },
  ];

  const folders = {};
  for (const config of folderConfigs) {
    let folder = speciesPack.folders.getName(config.name);
    if (!folder) {
      folder = await teriock.Folder.create(
        { name: config.name, type: "Item" },
        { pack: "teriock.species" },
      );
    }
    folders[config.variable] = folder;
  }

  await tm.utils.progressBar(
    Object.values(TERIOCK.index.creatures),
    "Pulling Species",
    async (name) => {
      let item = game.teriock.packs.species.index.getName(name);
      let folder = folders["allSpeciesFolder"];
      if (Object.values(TERIOCK.index.humanoids).includes(name)) {
        folder = folders["characterSpeciesFolder"];
      } else if (Object.values(TERIOCK.index.commonAnimals).includes(name)) {
        folder = folders["commonAnimalSpeciesFolder"];
      } else if (Object.values(TERIOCK.index.undead).includes(name)) {
        folder = folders["undeadSpeciesFolder"];
      }
      if (!item) {
        item = /** @type {TeriockSpecies} */ await teriock.Item.create(
          { name: name, type: "species", folder: folder.id },
          { pack: "teriock.species" },
        );
      }
      item = /** @type {TeriockSpecies} */ await tm.resolve.resolveDocument(item);
      await item.system.wikiPull({ notify: false });
    },
    { batch: 25 },
  );
flags: {}
_stats:
  coreVersion: '13'
  systemId: teriock
  systemVersion: 0.1.0
  lastModifiedBy: teriockBuilder00
  compendiumSource: null
_key: '!macros!U0WfGPoPSLSystNU'
