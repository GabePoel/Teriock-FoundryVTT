{
  "name": "Duel Macro - Pre-execution",
  "type": "script",
  "_id": "joj6xtjHNn2lD67k",
  "author": "Z8sCTHO0edFF1hYo",
  "img": "icons/svg/dice-target.svg",
  "scope": "global",
  "command": "const data = /** @type {Teriock.HookData.UseAbility} */ scope.data;\nconst buttons = data.rollConfig.chatData.system.buttons;\nconst applyButton = buttons.find((b) => b.label === \"Apply Effect\");\napplyButton.label = \"Apply Lighted\";\n\nconst token = game.teriock.api.utils.actorToken(actor).document || actor;\n\nfunction modifyData(data) {\n  const effectObject = JSON.parse(data);\n  effectObject.description = \"<ul>\";\n  effectObject.changes.push({\n    key: \"system.lightedTo\",\n    value: token.uuid || actor.uuid,\n    mode: 2,\n    priority: 10,\n  });\n  effectObject.description += `<li>Lighted to @UUID[${token.uuid}]{${token.name}}</li>`;\n  effectObject.description += \"</ul>\";\n  return JSON.stringify(effectObject);\n}\n\napplyButton.dataset.normal = modifyData(applyButton.dataset.normal);\napplyButton.dataset.crit = modifyData(applyButton.dataset.crit);",
  "folder": null,
  "sort": 0,
  "ownership": {
    "default": 0,
    "Z8sCTHO0edFF1hYo": 3
  },
  "flags": {},
  "_stats": {
    "compendiumSource": null,
    "duplicateSource": null,
    "exportSource": null,
    "coreVersion": "13.345",
    "systemId": "teriock",
    "systemVersion": "0.1.0",
    "createdTime": 1757035921013,
    "modifiedTime": 1757036746067,
    "lastModifiedBy": "Z8sCTHO0edFF1hYo"
  },
  "_key": "!macros!joj6xtjHNn2lD67k"
}
