{
  "name": "Generic Goad Macro - Pre-execution",
  "type": "script",
  "_id": "R54099tFLeLMmBAw",
  "author": "uxE8DDp7ujgsxtd2",
  "img": "icons/svg/dice-target.svg",
  "scope": "global",
  "command": "const data = /** @type {Teriock.HookData.UseAbility} */ scope.data;\nconst goadedToUuids = await game.teriock.api.dialogs.goadedToDialog();\nconst buttons = data.rollConfig.chatData.system.buttons;\ndata.rollConfig.chatData.system.buttons = buttons.filter(\n  (button) => button.dataset.action === \"apply-effect\",\n);\nconst button = data.rollConfig.chatData.system.buttons[0];\n\nasync function modifyData(data) {\n  const effectObject = JSON.parse(data);\n  effectObject.description = \"<ul>\";\n  for (const uuid of goadedToUuids) {\n    effectObject.changes.push({\n      key: \"system.goadedTo\",\n      value: uuid,\n      mode: 2,\n      priority: 10,\n    });\n    const token = await foundry.utils.fromUuid(uuid);\n    effectObject.description += `<li>Goaded to @UUID[${uuid}]{${token.name}}</li>`;\n  }\n  effectObject.description += \"</ul>\";\n  return JSON.stringify(effectObject);\n}\n\nbutton.dataset.normal = await modifyData(button.dataset.normal);\nbutton.dataset.crit = await modifyData(button.dataset.crit);",
  "folder": null,
  "sort": 1100000,
  "ownership": {
    "default": 0,
    "uxE8DDp7ujgsxtd2": 3
  },
  "flags": {},
  "_stats": {
    "compendiumSource": null,
    "duplicateSource": null,
    "exportSource": null,
    "coreVersion": "13.345",
    "systemId": "teriock",
    "systemVersion": "0.1.0",
    "createdTime": 1754236840908,
    "modifiedTime": 1757058247252,
    "lastModifiedBy": "Z8sCTHO0edFF1hYo"
  },
  "_key": "!macros!R54099tFLeLMmBAw"
}
