{
  "name": "Resist Effects Macro - Pre-execution",
  "type": "script",
  "_id": "5AsyrTgmr9NrD3XS",
  "author": "Z8sCTHO0edFF1hYo",
  "img": "icons/svg/dice-target.svg",
  "scope": "global",
  "command": "const data = /** @type {Teriock.HookData.UseAbility} */ scope.data;\nconst buttons = data.rollConfig.chatData.system.buttons;\nconst applyButton = buttons.find((b) => b.label === \"Apply Effect\");\n\nconst choices = {\n  awakening: \"Awakening\",\n  control: \"Control\",\n  displacement: \"Displacement\",\n  duelModifying: \"Duel modifying\",\n  financial: \"Financial\",\n  healing: \"Healing\",\n  killing: \"Killing\",\n  knockout: \"Knockout\",\n  loud: \"Loud\",\n  mental: \"Mental\",\n  poison: \"Poison\",\n  reanimation: \"Reanimation\",\n  regeneration: \"Regeneration\",\n  revitalization: \"Revitalization\",\n  revival: \"Revival\",\n  stealing: \"Stealing\",\n  summoning: \"Summoning\",\n  temporal: \"Temporal\",\n  transformation: \"Transformation\",\n  truthDetecting: \"Truth detecting\",\n};\n\nconst documents = Object.keys(choices).map((key) => {\n  return {\n    img: game.teriock.api.path.getIcon(\"effect-types\", choices[key]),\n    name: choices[key],\n    uuid: key,\n  };\n});\n\nconst choice = await game.teriock.api.dialogs.selectDocumentDialog(documents, {\n  hint: \"Select an effect type to resist.\",\n});\n\nfunction modifyData(data) {\n  const effectObject = JSON.parse(data);\n  effectObject.changes.push({\n    key: \"system.resistances.effects\",\n    value: choice.uuid,\n    mode: 2,\n    priority: 10,\n  });\n  return JSON.stringify(effectObject);\n}\n\napplyButton.dataset.normal = modifyData(applyButton.dataset.normal);\napplyButton.dataset.crit = modifyData(applyButton.dataset.crit);",
  "folder": null,
  "sort": 2500000,
  "ownership": {
    "default": 0,
    "Z8sCTHO0edFF1hYo": 3
  },
  "flags": {},
  "_stats": {
    "compendiumSource": null,
    "duplicateSource": null,
    "exportSource": null,
    "coreVersion": "13.345",
    "systemId": "teriock",
    "systemVersion": "0.1.0",
    "createdTime": 1757058203992,
    "modifiedTime": 1757058615913,
    "lastModifiedBy": "Z8sCTHO0edFF1hYo"
  },
  "_key": "!macros!5AsyrTgmr9NrD3XS"
}
