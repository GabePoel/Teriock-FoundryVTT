name: Might Strike - Pre-execution
type: script
_id: 0nUlKerGkkdmEuVW
author: teriockBuilder00
img: icons/svg/dice-target.svg
scope: global
command: |-
  const data = /** @type {Teriock.HookData.UseAbility} */ scope.data;
  const buttons = data.execution.buttons;
  data.execution.buttons = buttons.filter(
    (button) => button.dataset.action === "apply-effect",
  );
  const button = data.execution.buttons[0];
  const effectObject = JSON.parse(button.dataset.normal);
  const equipmentClass = await tm.dialogs.selectWeaponClassDialog();
  effectObject.system.impacts.changes[0] = {
    key: "system.damage.all.raw",
    qualifier: `@class.${equipmentClass}`,
    target: "armament",
    value: "1d4[holy]",
    mode: 2,
    priority: 10,
  };
  const effectString = JSON.stringify(effectObject);
  data.execution.buttons[0].dataset.normal = effectString;
  data.execution.buttons[0].dataset.crit = effectString;
flags: {}
_stats:
  coreVersion: '13'
  systemId: teriock
  systemVersion: 0.1.0
  lastModifiedBy: teriockBuilder00
  compendiumSource: null
_key: '!macros!0nUlKerGkkdmEuVW'
