_id: opAtkExecution00
_key: '!macros!opAtkExecution00'
_stats:
  coreVersion: '13'
  lastModifiedBy: teriockBuilder00
  systemId: teriock
  systemVersion: 0.9.16
author: teriockBuilder00
command: |-
  const data = /** @type {Teriock.HookData.UseAbility} */ scope.data;
  const options = data.execution.options
  const actor = data.execution.actor;
  let abilities = await actor.allAbilities();
  abilities = abilities
    .filter(
      (a) =>
        a.system.interaction === "attack" &&
        a.system.maneuver === "active" &&
        a.system.executionTime === "a1" &&
        ["weapon", "hand"].includes(a.system.delivery.base),
    )
    .sort((a, b) => a.name.localeCompare(b.name));
  const ability = await tm.dialogs.selectDocumentDialog(abilities, {
    title: "Select Ability",
    hint: "Select an ability to use.",
  });
  await ability.system.use(options);
img: icons/svg/dice-target.svg
name: Opportunity Attack - Execution
scope: global
type: script
