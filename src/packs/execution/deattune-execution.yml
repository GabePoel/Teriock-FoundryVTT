name: Deattune - Execution
type: script
_id: ARwwvQ4JsEm4MicQ
author: teriockBuilder00
img: icons/svg/dice-target.svg
scope: global
command: |-
  const data = /** @type {Teriock.HookData.UseAbility} */ scope.data;
  data.execution.buttons = [];
  const actor = data.execution.actor;
  const equipment = actor.equipment
    .filter((e) => e.system.isAttuned)
    .sort((a, b) => a.name.localeCompare(b.name));
  const selectedEquipment = await tm.dialogs.selectDocumentsDialog(equipment, {
    title: "Select Equipment",
    hint: "Select equipment to deattune.",
  });
  await Promise.all(selectedEquipment.map((e) => e.system.deattune()));
_stats:
  coreVersion: '13'
  systemId: teriock
  systemVersion: 0.1.0
  lastModifiedBy: teriockBuilder00
_key: '!macros!ARwwvQ4JsEm4MicQ'
