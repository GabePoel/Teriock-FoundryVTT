_id: attunePreExecuti
_key: '!macros!attunePreExecuti'
_stats:
  coreVersion: '13'
  lastModifiedBy: teriockBuilder00
  systemId: teriock
  systemVersion: 0.9.16
author: teriockBuilder00
command: |-
  const data = /** @type {Teriock.HookData.UseAbility} */ scope.data;
  data.execution.buttons = [];
  const actor = data.execution.actor;
  const equipment = actor.equipment
    .filter((e) => !e.system.isAttuned)
    .sort((a, b) => a.name.localeCompare(b.name));
  const selectedEquipment = await tm.dialogs.selectDocumentsDialog(equipment, {
    title: "Select Equipment",
    hint: "Select equipment to attune.",
    tooltip: true,
  });
  await Promise.all(selectedEquipment.map((e) => e.system.attune()));
img: icons/svg/dice-target.svg
name: Attune - Pre-execution
scope: global
type: script
